<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المنصة التعليمية المتطورة - نظام الإدارة المتكامل</title>
    
    <!-- الأيقونات -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.14.0/index.min.css">
    
    <!-- الأنماط -->
    <link rel="stylesheet" href="css/css.css">
    
    <!-- السكريبتات -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.14.0/index.min.js"></script>
    
    <!-- الأمان والأداء -->
    <meta name="description" content="منصة تعليمية متكاملة للتواصل والتعلم والتعاون بين الطلاب والمعلمين">
    <meta name="keywords" content="منصة تعليمية, تعلم إلكتروني, دردشة, محادثات, تعليم">
    <meta name="author" content="فريق المنصة التعليمية">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4361ee">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>
    <!-- شاشة التحميل -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <div class="loading-text">
                <h2>المنصة التعليمية</h2>
                <p>جاري تحميل التطبيق...</p>
            </div>
        </div>
    </div>

    <!-- شاشة الترحيب -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <div class="welcome-logo">
                <div class="logo-icon large">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1>المنصة التعليمية</h1>
                <p>نظام إدارة تعليمي متكامل ومتطور</p>
            </div>
            
            <div class="welcome-features">
                <div class="feature">
                    <i class="fas fa-comments"></i>
                    <span>دردشة مباشرة</span>
                </div>
                <div class="feature">
                    <i class="fas fa-users"></i>
                    <span>مجموعات تعليمية</span>
                </div>
                <div class="feature">
                    <i class="fas fa-play-circle"></i>
                    <span>فصول افتراضية</span>
                </div>
                <div class="feature">
                    <i class="fas fa-chart-line"></i>
                    <span>تتبع التقدم</span>
                </div>
            </div>
            
            <div class="welcome-actions">
                <button class="btn btn-primary btn-lg" id="startAppBtn">
                    <i class="fas fa-rocket"></i>
                    ابدأ الآن
                </button>
                <button class="btn btn-outline btn-lg" id="quickDemoBtn">
                    <i class="fas fa-eye"></i>
                    عرض سريع
                </button>
            </div>
        </div>
    </div>

    <!-- حالة الاتصال -->
    <div class="connection-status" id="connectionStatus">
        <i class="fas fa-wifi"></i>
        <span>جاري الاتصال...</span>
    </div>

    <!-- إشعار التحديث -->
    <div class="update-notification" id="updateNotification" style="display: none;">
        <div class="update-content">
            <i class="fas fa-sync-alt fa-spin"></i>
            <div class="update-info">
                <strong>تحديث جديد متاح</strong>
                <span>يتم تحميل التحديثات تلقائياً</span>
            </div>
        </div>
        <button class="btn btn-sm btn-outline" id="reloadBtn">
            <i class="fas fa-redo"></i>
            تحديث الآن
        </button>
    </div>

    <!-- الإشعارات العائمة -->
    <div class="notifications-container" id="notificationsContainer"></div>

    <!-- الهيدر -->
    <header class="header" id="header">
        <div class="header-content">
            <!-- الشعار -->
            <a href="#" class="logo" data-page="home">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="logo-text">
                    <div class="logo-title">المنصة التعليمية</div>
                    <div class="logo-subtitle">نظام الإدارة المتكامل</div>
                </div>
            </a>

            <!-- التنقل الرئيسي -->
            <nav class="nav">
                <a href="#" class="nav-item" data-page="home">
                    <i class="fas fa-home"></i>
                    الرئيسية
                </a>
                <a href="#" class="nav-item" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    لوحة التحكم
                </a>
                <a href="#" class="nav-item" data-page="chat">
                    <i class="fas fa-comments"></i>
                    الدردشة
                    <span class="nav-item-badge" id="unreadMessagesCount">0</span>
                </a>
                <a href="#" class="nav-item" data-page="stories">
                    <i class="fas fa-history"></i>
                    القصص
                </a>
                <a href="#" class="nav-item" data-page="groups">
                    <i class="fas fa-users"></i>
                    المجموعات
                </a>
                <a href="#" class="nav-item" data-page="channels">
                    <i class="fas fa-broadcast-tower"></i>
                    القنوات
                </a>
                <a href="#" class="nav-item" data-page="media">
                    <i class="fas fa-photo-video"></i>
                    الوسائط
                </a>
                
                <!-- عناصر للمستخدمين غير المسجلين -->
                <a href="#" class="nav-item unauth-only" id="loginBtn" data-page="login">
                    <i class="fas fa-sign-in-alt"></i>
                    تسجيل الدخول
                </a>
                <a href="#" class="nav-item unauth-only" id="registerBtn" data-page="register">
                    <i class="fas fa-user-plus"></i>
                    إنشاء حساب
                </a>
                
                <!-- عناصر للمستخدمين المسجلين -->
                <a href="#" class="nav-item auth-only" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    تسجيل الخروج
                </a>
            </nav>

            <!-- معلومات المستخدم -->
            <div class="user-info auth-only" id="userInfo">
                <div class="user-avatar" id="userAvatar">
                    <span id="userAvatarText">م</span>
                </div>
                <div class="user-details">
                    <div class="user-name" id="userNameDisplay">محمد أحمد</div>
                    <div class="user-role" id="userRoleDisplay">طالب</div>
                </div>
                <div class="user-status-indicator" id="userStatusIndicator"></div>
            </div>

            <!-- زر القائمة المتنقلة -->
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- القائمة المتنقلة -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <div class="user-info">
                <div class="user-avatar">
                    <span id="mobileUserAvatarText">م</span>
                </div>
                <div class="user-details">
                    <div class="user-name" id="mobileUserNameDisplay">محمد أحمد</div>
                    <div class="user-role" id="mobileUserRoleDisplay">طالب</div>
                </div>
            </div>
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <nav class="mobile-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                الرئيسية
            </a>
            <a href="#" class="nav-item" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                لوحة التحكم
            </a>
            <a href="#" class="nav-item" data-page="chat">
                <i class="fas fa-comments"></i>
                الدردشة
                <span class="nav-item-badge" id="unreadMessagesCountMobile">0</span>
            </a>
            <a href="#" class="nav-item" data-page="stories">
                <i class="fas fa-history"></i>
                القصص
            </a>
            <a href="#" class="nav-item" data-page="groups">
                <i class="fas fa-users"></i>
                المجموعات
            </a>
            <a href="#" class="nav-item" data-page="channels">
                <i class="fas fa-broadcast-tower"></i>
                القنوات
            </a>
            <a href="#" class="nav-item" data-page="media">
                <i class="fas fa-photo-video"></i>
                الوسائط
            </a>
            <a href="#" class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                الإعدادات
            </a>
            
            <!-- عناصر للمستخدمين غير المسجلين -->
            <a href="#" class="nav-item unauth-only" data-page="login">
                <i class="fas fa-sign-in-alt"></i>
                تسجيل الدخول
            </a>
            <a href="#" class="nav-item unauth-only" data-page="register">
                <i class="fas fa-user-plus"></i>
                إنشاء حساب
            </a>
            
            <!-- عناصر للمستخدمين المسجلين -->
            <a href="#" class="nav-item auth-only" id="logoutBtnMobile">
                <i class="fas fa-sign-out-alt"></i>
                تسجيل الخروج
            </a>
        </nav>
    </div>

    <!-- طبقة التعتيم -->
    <div class="overlay" id="overlay"></div>

    <!-- المحتوى الرئيسي -->
    <main class="main-content">
        <!-- الصفحة الرئيسية -->
        <div class="page active" id="home-page">
            <div class="home-hero">
                <div class="hero-content">
                    <h1>مرحباً بك في المنصة التعليمية</h1>
                    <p>منصة متكاملة للتعلم والتعاون والتواصل بين الطلاب والمعلمين</p>
                    <div class="hero-actions">
                        <button class="btn btn-primary btn-lg unauth-only" data-page="register">
                            <i class="fas fa-user-plus"></i>
                            انضم إلينا
                        </button>
                        <button class="btn btn-outline btn-lg unauth-only" data-page="login">
                            <i class="fas fa-sign-in-alt"></i>
                            تسجيل الدخول
                        </button>
                        <button class="btn btn-primary btn-lg auth-only" data-page="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            لوحة التحكم
                        </button>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-graduation-cap"></i>
                </div>
            </div>

            <div class="features-section">
                <h2 class="section-title">مميزات المنصة</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>دردشة مباشرة</h3>
                        <p>تواصل فوري مع الزملاء والمعلمين عبر نظام دردشة متكامل</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>مجموعات تعليمية</h3>
                        <p>أنشئ مجموعات دراسية وناقش مواضيعك مع زملائك</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-broadcast-tower"></i>
                        </div>
                        <h3>قنوات البث</h3>
                        <p>انضم إلى قنوات تعليمية متخصصة واحصل على آخر المستجدات</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3>القصص التعليمية</h3>
                        <p>شارك تجاربك التعليمية عبر القصص التفاعلية</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-photo-video"></i>
                        </div>
                        <h3>وسائط متعددة</h3>
                        <p>شارك ومشاهدة الوسائط التعليمية بجودة عالية</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>تتبع التقدم</h3>
                        <p>تابع تقدمك التعليمي واحصل على تقارير أداء مفصلة</p>
                    </div>
                </div>
            </div>

            <!-- إحصائيات سريعة -->
            <div class="stats-section auth-only">
                <h2 class="section-title">إحصائيات سريعة</h2>
                <div class="stats-grid" id="quickStats">
                    <!-- سيتم ملؤها ديناميكياً -->
                </div>
            </div>
        </div>

        <!-- صفحة تسجيل الدخول -->
        <div class="page" id="login-page">
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <h2>تسجيل الدخول</h2>
                        <p>ادخل إلى حسابك للمتابعة</p>
                    </div>
                    <form class="auth-form" id="loginForm">
                        <div class="form-group">
                            <label for="loginEmail">
                                <i class="fas fa-envelope"></i>
                                البريد الإلكتروني
                            </label>
                            <input type="email" id="loginEmail" name="email" required placeholder="ادخل بريدك الإلكتروني">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">
                                <i class="fas fa-lock"></i>
                                كلمة المرور
                            </label>
                            <input type="password" id="loginPassword" name="password" required placeholder="ادخل كلمة المرور">
                            <button type="button" class="password-toggle" id="toggleLoginPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="form-options">
                            <label class="checkbox">
                                <input type="checkbox" id="rememberMe">
                                <span class="checkmark"></span>
                                تذكرني
                            </label>
                            <a href="#" class="forgot-password" id="forgotPasswordBtn">
                                نسيت كلمة المرور؟
                            </a>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" id="loginSubmitBtn">
                            <i class="fas fa-sign-in-alt"></i>
                            تسجيل الدخول
                        </button>
                    </form>
                    <div class="auth-divider">
                        <span>أو</span>
                    </div>
                    <div class="auth-social">
                        <button class="btn btn-outline btn-block" id="googleLoginBtn">
                            <i class="fab fa-google"></i>
                            متابعة مع جوجل
                        </button>
                    </div>
                    <div class="auth-footer">
                        <p>ليس لديك حساب؟ <a href="#" data-page="register">أنشئ حساب جديد</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة إنشاء حساب -->
        <div class="page" id="register-page">
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <h2>إنشاء حساب جديد</h2>
                        <p>انضم إلى منصتنا التعليمية</p>
                    </div>
                    <form class="auth-form" id="registerForm">
                        <div class="form-group">
                            <label for="registerName">
                                <i class="fas fa-user"></i>
                                الاسم الكامل
                            </label>
                            <input type="text" id="registerName" name="fullName" required placeholder="ادخل اسمك الكامل">
                        </div>
                        <div class="form-group">
                            <label for="registerEmail">
                                <i class="fas fa-envelope"></i>
                                البريد الإلكتروني
                            </label>
                            <input type="email" id="registerEmail" name="email" required placeholder="ادخل بريدك الإلكتروني">
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">
                                <i class="fas fa-lock"></i>
                                كلمة المرور
                            </label>
                            <input type="password" id="registerPassword" name="password" required placeholder="اختر كلمة مرور قوية">
                            <button type="button" class="password-toggle" id="toggleRegisterPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                            <div class="password-strength" id="passwordStrength">
                                <div class="strength-bar"></div>
                                <span class="strength-text">قوة كلمة المرور</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="registerRole">
                                <i class="fas fa-user-tag"></i>
                                الدور
                            </label>
                            <select id="registerRole" name="role" required>
                                <option value="">اختر دورك</option>
                                <option value="student">طالب</option>
                                <option value="teacher">معلم</option>
                            </select>
                        </div>
                        <div class="form-options">
                            <label class="checkbox">
                                <input type="checkbox" id="agreeTerms" required>
                                <span class="checkmark"></span>
                                أوافق على <a href="#" id="termsLink">الشروط والأحكام</a>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" id="registerSubmitBtn">
                            <i class="fas fa-user-plus"></i>
                            إنشاء حساب
                        </button>
                    </form>
                    <div class="auth-footer">
                        <p>لديك حساب بالفعل؟ <a href="#" data-page="login">سجل الدخول</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة لوحة التحكم -->
        <div class="page" id="dashboard-page">
            <div class="dashboard-header">
                <h1 class="section-title">
                    <i class="fas fa-tachometer-alt"></i>
                    لوحة التحكم
                </h1>
                <div class="dashboard-actions">
                    <button class="btn btn-outline" id="refreshDashboardBtn">
                        <i class="fas fa-sync-alt"></i>
                        تحديث
                    </button>
                </div>
            </div>
            
            <div class="dashboard-content">
                <div class="welcome-card auth-only">
                    <div class="welcome-message">
                        <h2 id="dashboardWelcome">مرحباً، محمد!</h2>
                        <p id="dashboardDate">الاثنين، 1 يناير 2024</p>
                    </div>
                    <div class="quick-stats" id="dashboardQuickStats">
                        <!-- سيتم ملؤها ديناميكياً -->
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- الإحصائيات -->
                    <div class="dashboard-section">
                        <h3>الإحصائيات</h3>
                        <div class="stats-cards" id="dashboardStats">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>

                    <!-- النشاطات الأخيرة -->
                    <div class="dashboard-section">
                        <h3>النشاطات الأخيرة</h3>
                        <div class="activities-list" id="recentActivities">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>

                    <!-- المحادثات النشطة -->
                    <div class="dashboard-section">
                        <h3>المحادثات النشطة</h3>
                        <div class="conversations-preview" id="activeConversations">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>

                    <!-- الإشعارات -->
                    <div class="dashboard-section">
                        <h3>الإشعارات</h3>
                        <div class="notifications-list" id="dashboardNotifications">
                            <!-- سيتم ملؤها ديناميكياً -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة الدردشة -->
        <div class="page" id="chat-page">
            <div class="chat-container">
                <!-- الشريط الجانبي للمحادثات -->
                <div class="chat-sidebar active" id="chatSidebar">
                    <div class="chat-header">
                        <h3>المحادثات</h3>
                        <div class="chat-actions">
                            <button class="btn btn-primary btn-sm" id="newChatBtn" title="محادثة جديدة">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="btn btn-outline btn-sm" id="refreshChatsBtn" title="تحديث المحادثات">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="chat-search">
                        <div class="search-input-wrapper">
                            <i class="fas fa-search"></i>
                            <input type="text" id="chatSearchInput" placeholder="بحث في المحادثات...">
                            <button class="search-clear" id="clearSearchBtn" style="display: none;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="conversations-tabs">
                        <button class="tab-btn active" data-tab="all">الكل</button>
                        <button class="tab-btn" data-tab="unread">غير المقروء</button>
                        <button class="tab-btn" data-tab="groups">المجموعات</button>
                    </div>
                    
                    <div class="conversations-list" id="conversationsList">
                        <!-- سيتم ملء المحادثات ديناميكياً -->
                    </div>
                </div>
                
                <!-- منطقة المحادثة الرئيسية -->
                <div class="chat-main">
                    <div class="chat-header" id="activeChatHeader">
                        <div class="chat-user-info">
                            <div class="conversation-avatar small">
                                <span id="activeChatAvatar">?</span>
                            </div>
                            <div class="conversation-details">
                                <div class="conversation-name" id="activeChatName">اختر محادثة</div>
                                <div class="user-status-text" id="activeChatStatus">غير متصل</div>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="chat-tool-btn" id="voiceCallBtn" title="مكالمة صوتية">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="chat-tool-btn" id="videoCallBtn" title="مكالمة فيديو">
                                <i class="fas fa-video"></i>
                            </button>
                            <button class="chat-tool-btn" id="chatInfoBtn" title="معلومات المحادثة">
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <button class="chat-toggle" id="chatToggleMain">
                                <i class="fas fa-bars"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        <div class="empty-chat" id="emptyChat">
                            <i class="fas fa-comments"></i>
                            <h3>مرحباً في الدردشة</h3>
                            <p>اختر محادثة لبدء التحدث</p>
                        </div>
                    </div>

                    <!-- مؤشر الكتابة -->
                    <div class="typing-indicator" id="typingIndicator" style="display: none;">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span id="typingUsersText">شخص يكتب...</span>
                    </div>
                    
                    <div class="chat-input-container" id="chatInputContainer" style="display: none;">
                        <div class="chat-input-tools">
                            <button class="chat-tool-btn" id="attachFileBtn" title="إرفاق ملف">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button class="chat-tool-btn" id="attachImageBtn" title="إرسال صورة">
                                <i class="fas fa-image"></i>
                            </button>
                            <button class="chat-tool-btn" id="emojiToggle" title="إدراج إيموجي">
                                <i class="fas fa-smile"></i>
                            </button>
                            <input type="file" id="fileInput" style="display: none;" accept="*/*">
                            <input type="file" id="imageInput" style="display: none;" accept="image/*">
                        </div>
                        
                        <div class="chat-input-wrapper">
                            <textarea placeholder="اكتب رسالة..." id="chatInput" rows="1"></textarea>
                        </div>
                        
                        <button class="send-btn" id="sendMessageBtn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    
                    <!-- منتقي الإيموجي -->
                    <div class="emoji-picker-container" id="emojiPickerContainer">
                        <emoji-picker></emoji-picker>
                    </div>
                </div>

                <!-- معلومات المحادثة -->
                <div class="chat-info-sidebar" id="chatInfoSidebar">
                    <div class="chat-info-header">
                        <h4>معلومات المحادثة</h4>
                        <button class="chat-info-close" id="chatInfoClose">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="chat-info-content" id="chatInfoContent">
                        <!-- سيتم ملؤها ديناميكياً -->
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة القصص -->
        <div class="page" id="stories-page">
            <div class="stories-header">
                <h1 class="section-title">
                    <i class="fas fa-history"></i>
                    القصص
                </h1>
                <div class="stories-actions">
                    <button class="btn btn-primary" id="createStoryBtn">
                        <i class="fas fa-plus"></i>
                        إضافة قصة
                    </button>
                    <button class="btn btn-outline" id="refreshStoriesBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="stories-container" id="storiesContainer">
                <!-- سيتم ملء القصص ديناميكياً -->
            </div>

            <!-- مشغل القصص -->
            <div class="story-viewer" id="storyViewer">
                <div class="story-overlay"></div>
                <div class="story-content">
                    <button class="story-close" id="storyClose">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="story-progress" id="storyProgress">
                        <!-- سيتم ملء شريط التقدم ديناميكياً -->
                    </div>
                    <div class="story-media">
                        <img id="currentStoryImage" src="" alt="قصة" style="display: none;">
                        <video id="currentStoryVideo" controls style="display: none;"></video>
                    </div>
                    <div class="story-info">
                        <div class="story-author-avatar">
                            <span id="storyAuthorAvatar">?</span>
                        </div>
                        <div class="story-author-info">
                            <div class="story-author-name" id="storyAuthorName"></div>
                            <div class="story-time" id="storyTime"></div>
                        </div>
                        <div class="story-actions">
                            <button class="story-action-btn" id="likeStoryBtn">
                                <i class="far fa-heart"></i>
                            </button>
                            <button class="story-action-btn" id="replyStoryBtn">
                                <i class="far fa-comment"></i>
                            </button>
                            <button class="story-action-btn" id="shareStoryBtn">
                                <i class="fas fa-share"></i>
                            </button>
                        </div>
                    </div>
                    <div class="story-nav prev" id="storyPrev">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="story-nav next" id="storyNext">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة المجموعات -->
        <div class="page" id="groups-page">
            <div class="groups-header">
                <h1 class="section-title">
                    <i class="fas fa-users"></i>
                    المجموعات التعليمية
                </h1>
                <div class="groups-actions">
                    <button class="btn btn-primary" id="createGroupBtn">
                        <i class="fas fa-plus"></i>
                        إنشاء مجموعة
                    </button>
                    <button class="btn btn-outline" id="refreshGroupsBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="groups-container">
                <div class="groups-tabs">
                    <button class="tab-btn active" data-tab="my-groups">مجموعاتي</button>
                    <button class="tab-btn" data-tab="discover-groups">اكتشف المجموعات</button>
                    <button class="tab-btn" data-tab="public-groups">المجموعات العامة</button>
                </div>
                
                <div class="groups-grid" id="groupsGrid">
                    <!-- سيتم ملء المجموعات ديناميكياً -->
                </div>
            </div>
        </div>

        <!-- صفحة القنوات -->
        <div class="page" id="channels-page">
            <div class="channels-header">
                <h1 class="section-title">
                    <i class="fas fa-broadcast-tower"></i>
                    القنوات التعليمية
                </h1>
                <div class="channels-actions">
                    <button class="btn btn-primary" id="createChannelBtn">
                        <i class="fas fa-plus"></i>
                        إنشاء قناة
                    </button>
                    <button class="btn btn-outline" id="refreshChannelsBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="channels-container">
                <div class="channels-tabs">
                    <button class="tab-btn active" data-tab="my-channels">قنواتي</button>
                    <button class="tab-btn" data-tab="discover-channels">اكتشف القنوات</button>
                    <button class="tab-btn" data-tab="popular-channels">القنوات الشائعة</button>
                </div>
                
                <div class="channels-grid" id="channelsGrid">
                    <!-- سيتم ملء القنوات ديناميكياً -->
                </div>
            </div>
        </div>

        <!-- صفحة الوسائط -->
        <div class="page" id="media-page">
            <div class="media-header">
                <h1 class="section-title">
                    <i class="fas fa-photo-video"></i>
                    الوسائط التعليمية
                </h1>
                <div class="media-actions">
                    <button class="btn btn-primary" id="uploadMediaBtn">
                        <i class="fas fa-upload"></i>
                        رفع وسائط
                    </button>
                    <div class="media-filter">
                        <select id="mediaFilter">
                            <option value="all">جميع الوسائط</option>
                            <option value="image">الصور</option>
                            <option value="video">الفيديوهات</option>
                            <option value="document">المستندات</option>
                            <option value="audio">الصوتيات</option>
                        </select>
                    </div>
                    <button class="btn btn-outline" id="refreshMediaBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="media-container">
                <div class="media-stats">
                    <div class="media-stat">
                        <span class="stat-number" id="totalMedia">0</span>
                        <span class="stat-label">إجمالي الوسائط</span>
                    </div>
                    <div class="media-stat">
                        <span class="stat-number" id="totalSize">0 MB</span>
                        <span class="stat-label">الحجم الإجمالي</span>
                    </div>
                </div>
                
                <div class="media-grid" id="mediaGrid">
                    <!-- سيتم ملء الوسائط ديناميكياً -->
                </div>
            </div>
        </div>

        <!-- صفحة الإعدادات -->
        <div class="page" id="settings-page">
            <div class="settings-container">
                <h1 class="section-title">
                    <i class="fas fa-cog"></i>
                    الإعدادات
                </h1>
                
                <div class="settings-grid">
                    <div class="settings-sidebar">
                        <div class="settings-nav">
                            <button class="settings-nav-item active" data-tab="profile">
                                <i class="fas fa-user"></i>
                                الملف الشخصي
                            </button>
                            <button class="settings-nav-item" data-tab="privacy">
                                <i class="fas fa-shield-alt"></i>
                                الخصوصية
                            </button>
                            <button class="settings-nav-item" data-tab="notifications">
                                <i class="fas fa-bell"></i>
                                الإشعارات
                            </button>
                            <button class="settings-nav-item" data-tab="appearance">
                                <i class="fas fa-palette"></i>
                                المظهر
                            </button>
                            <button class="settings-nav-item" data-tab="security">
                                <i class="fas fa-lock"></i>
                                الأمان
                            </button>
                            <button class="settings-nav-item" data-tab="account">
                                <i class="fas fa-cog"></i>
                                إعدادات الحساب
                            </button>
                        </div>
                    </div>
                    
                    <div class="settings-content">
                        <!-- تبويب الملف الشخصي -->
                        <div class="settings-tab active" id="profile-tab">
                            <h3>الملف الشخصي</h3>
                            <form class="settings-form" id="profileForm">
                                <div class="avatar-upload">
                                    <div class="avatar-preview" id="avatarPreview">
                                        <img id="avatarImage" src="" alt="الصورة الشخصية">
                                        <span id="avatarInitials">م</span>
                                    </div>
                                    <div class="avatar-actions">
                                        <button type="button" class="btn btn-outline btn-sm" id="changeAvatarBtn">
                                            تغيير الصورة
                                        </button>
                                        <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profileName">الاسم الكامل</label>
                                        <input type="text" id="profileName" name="fullName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="profileEmail">البريد الإلكتروني</label>
                                        <input type="email" id="profileEmail" name="email" required>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="profileBio">نبذة شخصية</label>
                                    <textarea id="profileBio" name="bio" rows="4" placeholder="اكتب نبذة عن نفسك..."></textarea>
                                    <div class="char-count">
                                        <span id="bioCharCount">0</span>/500
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profilePhone">رقم الهاتف</label>
                                        <input type="tel" id="profilePhone" name="phone">
                                    </div>
                                    <div class="form-group">
                                        <label for="profileLocation">المكان</label>
                                        <input type="text" id="profileLocation" name="location">
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">حفظ التغييرات</button>
                                    <button type="button" class="btn btn-outline" id="cancelProfileChanges">إلغاء</button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- تبويب الخصوصية -->
                        <div class="settings-tab" id="privacy-tab">
                            <h3>إعدادات الخصوصية</h3>
                            <div class="privacy-settings">
                                <div class="privacy-section">
                                    <h4>الملف الشخصي</h4>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إظهار حالة الاتصال</h5>
                                            <p>السماح للآخرين برؤية ما إذا كنت متصلاً أم لا</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="showOnlineStatus" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إظهار آخر ظهور</h5>
                                            <p>السماح للآخرين برؤية وقت آخر ظهور لك</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="showLastSeen" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>الملف الشخصي العام</h5>
                                            <p>جعل ملفك الشخصي مرئياً للجميع</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="publicProfile">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="privacy-section">
                                    <h4>الرسائل</h4>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>قبول الرسائل من الجميع</h5>
                                            <p>السماح لأي شخص بإرسال رسائل لك</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="acceptAllMessages" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>طلب المصادقة</h5>
                                            <p>طلب الموافقة قبل بدء محادثة جديدة</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="requireAuth">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn btn-primary" id="savePrivacySettings">حفظ الإعدادات</button>
                                </div>
                            </div>
                        </div>

                        <!-- تبويب الإشعارات -->
                        <div class="settings-tab" id="notifications-tab">
                            <h3>إعدادات الإشعارات</h3>
                            <div class="privacy-settings">
                                <div class="privacy-section">
                                    <h4>الإشعارات العامة</h4>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>تفعيل الإشعارات</h5>
                                            <p>استقبال الإشعارات من المنصة</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="enableNotifications" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>الأصوات</h5>
                                            <p>تشغيل أصوات للإشعارات</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="enableSounds" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="privacy-section">
                                    <h4>أنواع الإشعارات</h4>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إشعارات الرسائل</h5>
                                            <p>تلقي إشعارات عند وصول رسائل جديدة</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="messageNotifications" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إشعارات المجموعات</h5>
                                            <p>تلقي إشعارات من المجموعات</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="groupNotifications" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إشعارات القنوات</h5>
                                            <p>تلقي إشعارات من القنوات</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="channelNotifications" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>إشعارات الستوريات</h5>
                                            <p>تلقي إشعارات عند نشر ستوريات جديدة</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="storyNotifications" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn btn-primary" id="saveNotificationSettings">حفظ الإعدادات</button>
                                </div>
                            </div>
                        </div>

                        <!-- تبويب المظهر -->
                        <div class="settings-tab" id="appearance-tab">
                            <h3>إعدادات المظهر</h3>
                            <div class="appearance-settings">
                                <div class="form-group">
                                    <label for="themeSelect">السمة</label>
                                    <select id="themeSelect" class="form-control">
                                        <option value="auto">تلقائي (يتابع نظام الجهاز)</option>
                                        <option value="light">فاتح</option>
                                        <option value="dark">داكن</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="fontSize">حجم الخط</label>
                                    <select id="fontSize" class="form-control">
                                        <option value="small">صغير</option>
                                        <option value="medium" selected>متوسط</option>
                                        <option value="large">كبير</option>
                                        <option value="x-large">كبير جداً</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="languageSelect">اللغة</label>
                                    <select id="languageSelect" class="form-control">
                                        <option value="ar" selected>العربية</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>كثافة العناصر</label>
                                    <div class="density-options">
                                        <label class="radio">
                                            <input type="radio" name="density" value="compact" checked>
                                            <span class="radio-checkmark"></span>
                                            مدمج
                                        </label>
                                        <label class="radio">
                                            <input type="radio" name="density" value="comfortable">
                                            <span class="radio-checkmark"></span>
                                            مريح
                                        </label>
                                        <label class="radio">
                                            <input type="radio" name="density" value="spacious">
                                            <span class="radio-checkmark"></span>
                                            فسيح
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn btn-primary" id="saveAppearanceSettings">حفظ الإعدادات</button>
                                    <button type="button" class="btn btn-outline" id="resetAppearanceSettings">إعادة التعيين</button>
                                </div>
                            </div>
                        </div>

                        <!-- تبويب الأمان -->
                        <div class="settings-tab" id="security-tab">
                            <h3>إعدادات الأمان</h3>
                            <div class="security-settings">
                                <div class="security-section">
                                    <h4>كلمة المرور</h4>
                                    <form class="security-form" id="changePasswordForm">
                                        <div class="form-group">
                                            <label for="currentPassword">كلمة المرور الحالية</label>
                                            <input type="password" id="currentPassword" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="newPassword">كلمة المرور الجديدة</label>
                                            <input type="password" id="newPassword" required>
                                            <div class="password-strength">
                                                <div class="strength-bar"></div>
                                                <span class="strength-text">قوة كلمة المرور</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="confirmPassword">تأكيد كلمة المرور الجديدة</label>
                                            <input type="password" id="confirmPassword" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">تغيير كلمة المرور</button>
                                    </form>
                                </div>
                                
                                <div class="security-section">
                                    <h4>جلسات التسجيل</h4>
                                    <div class="sessions-list" id="sessionsList">
                                        <!-- سيتم ملؤها ديناميكياً -->
                                    </div>
                                    <button type="button" class="btn btn-outline" id="logoutAllSessionsBtn">
                                        تسجيل الخروج من جميع الجلسات
                                    </button>
                                </div>
                                
                                <div class="security-section">
                                    <h4>خيارات متقدمة</h4>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>المصادقة الثنائية</h5>
                                            <p>إضافة طبقة أمان إضافية لحسابك</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="twoFactorAuth">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="privacy-item">
                                        <div class="privacy-info">
                                            <h5>تسجيلات الدخول المشبوهة</h5>
                                            <p>إشعارني عند محاولات تسجيل دخول غير معتادة</p>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="suspiciousLoginAlerts" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- تبويب إعدادات الحساب -->
                        <div class="settings-tab" id="account-tab">
                            <h3>إعدادات الحساب</h3>
                            <div class="account-settings">
                                <div class="account-section">
                                    <h4>معلومات الحساب</h4>
                                    <div class="account-info">
                                        <div class="info-item">
                                            <span class="info-label">تاريخ الإنشاء:</span>
                                            <span class="info-value" id="accountCreatedAt">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">آخر نشاط:</span>
                                            <span class="info-value" id="lastActivity">-</span>
                                        </div>
                                        <div class="info-item">
                                            <span class="info-label">حالة الحساب:</span>
                                            <span class="info-value status-active" id="accountStatus">نشط</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="account-section">
                                    <h4>إجراءات الحساب</h4>
                                    <div class="account-actions">
                                        <button class="btn btn-outline" id="exportDataBtn">
                                            <i class="fas fa-download"></i>
                                            تصدير بياناتي
                                        </button>
                                        <button class="btn btn-outline" id="deactivateAccountBtn">
                                            <i class="fas fa-user-slash"></i>
                                            إلغاء تنشيط الحساب
                                        </button>
                                        <button class="btn btn-danger" id="deleteAccountBtn">
                                            <i class="fas fa-trash"></i>
                                            حذف الحساب
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="account-section">
                                    <h4>الاشتراك</h4>
                                    <div class="subscription-info">
                                        <div class="subscription-status">
                                            <span class="status-badge free">مجاني</span>
                                            <p>أنت تستخدم الخطة المجانية حالياً</p>
                                        </div>
                                        <button class="btn btn-primary" id="upgradePlanBtn">
                                            <i class="fas fa-crown"></i>
                                            الترقية إلى الخطة المميزة
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- شريط الأدوات السريع -->
    <div class="quick-actions-bar" id="quickActionsBar">
        <button class="quick-action" data-page="chat" title="الدردشة">
            <i class="fas fa-comments"></i>
        </button>
        <button class="quick-action" data-page="stories" title="القصص">
            <i class="fas fa-history"></i>
        </button>
        <button class="quick-action" data-page="groups" title="المجموعات">
            <i class="fas fa-users"></i>
        </button>
        <button class="quick-action" data-page="channels" title="القنوات">
            <i class="fas fa-broadcast-tower"></i>
        </button>
        <button class="quick-action" data-page="dashboard" title="لوحة التحكم">
            <i class="fas fa-tachometer-alt"></i>
        </button>
    </div>

    <!-- الزر العائم -->
    <button class="floating-action-btn" id="floatingActionBtn">
        <i class="fas fa-plus"></i>
    </button>

    <!-- القائمة العائمة -->
    <div class="floating-menu" id="floatingMenu">
        <button class="floating-menu-item" data-action="new-chat">
            <i class="fas fa-comment"></i>
            محادثة جديدة
        </button>
        <button class="floating-menu-item" data-action="new-group">
            <i class="fas fa-users"></i>
            مجموعة جديدة
        </button>
        <button class="floating-menu-item" data-action="new-channel">
            <i class="fas fa-broadcast-tower"></i>
            قناة جديدة
        </button>
        <button class="floating-menu-item" data-action="new-story">
            <i class="fas fa-camera"></i>
            قصة جديدة
        </button>
    </div>

    <!-- === النماذج المنبثقة === -->

    <!-- نموذج إنشاء مجموعة -->
    <div class="modal" id="createGroupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء مجموعة جديدة</h3>
                <button class="modal-close" id="closeGroupModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createGroupForm">
                    <div class="form-group">
                        <label for="groupName">اسم المجموعة</label>
                        <input type="text" id="groupName" name="groupName" required placeholder="ادخل اسم المجموعة">
                    </div>
                    <div class="form-group">
                        <label for="groupDescription">وصف المجموعة</label>
                        <textarea id="groupDescription" name="groupDescription" rows="3" placeholder="ادخل وصف المجموعة"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="groupPrivacy">خصوصية المجموعة</label>
                        <select id="groupPrivacy" name="groupPrivacy">
                            <option value="public">عامة</option>
                            <option value="private">خاصة</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>صورة المجموعة</label>
                        <div class="avatar-upload">
                            <div class="avatar-preview" id="groupAvatarPreview">
                                <i class="fas fa-users"></i>
                            </div>
                            <button type="button" class="btn btn-outline btn-sm" id="changeGroupAvatarBtn">
                                تغيير الصورة
                            </button>
                            <input type="file" id="groupAvatarInput" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelGroupBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إنشاء المجموعة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج إنشاء قناة -->
    <div class="modal" id="createChannelModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء قناة جديدة</h3>
                <button class="modal-close" id="closeChannelModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createChannelForm">
                    <div class="form-group">
                        <label for="channelName">اسم القناة</label>
                        <input type="text" id="channelName" name="channelName" required placeholder="ادخل اسم القناة">
                    </div>
                    <div class="form-group">
                        <label for="channelDescription">وصف القناة</label>
                        <textarea id="channelDescription" name="channelDescription" rows="3" placeholder="ادخل وصف القناة"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="channelCategory">تصنيف القناة</label>
                        <select id="channelCategory" name="channelCategory">
                            <option value="education">تعليمي</option>
                            <option value="entertainment">ترفيهي</option>
                            <option value="news">أخباري</option>
                            <option value="technology">تكنولوجيا</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>صورة القناة</label>
                        <div class="avatar-upload">
                            <div class="avatar-preview" id="channelAvatarPreview">
                                <i class="fas fa-broadcast-tower"></i>
                            </div>
                            <button type="button" class="btn btn-outline btn-sm" id="changeChannelAvatarBtn">
                                تغيير الصورة
                            </button>
                            <input type="file" id="channelAvatarInput" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelChannelBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إنشاء القناة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج رفع الوسائط -->
    <div class="modal" id="uploadMediaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>رفع وسائط جديدة</h3>
                <button class="modal-close" id="closeUploadModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="uploadMediaForm">
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>اسحب وأفلت الملفات هنا أو انقر للاختيار</p>
                        <input type="file" id="mediaFileInput" multiple style="display: none;" accept="image/*,video/*,.pdf,.doc,.docx,.mp3,.wav">
                    </div>
                    <div class="upload-progress" id="uploadProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="progress-text" id="progressText">0%</span>
                    </div>
                    <div class="form-group">
                        <label for="mediaTitle">عنوان الوسائط</label>
                        <input type="text" id="mediaTitle" placeholder="ادخل عنوان الوسائط">
                    </div>
                    <div class="form-group">
                        <label for="mediaDescription">وصف الوسائط</label>
                        <textarea id="mediaDescription" rows="3" placeholder="ادخل وصف الوسائط"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelUploadBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">رفع الوسائط</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج إنشاء قصة -->
    <div class="modal" id="createStoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء قصة جديدة</h3>
                <button class="modal-close" id="closeStoryModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createStoryForm">
                    <div class="upload-area" id="storyUploadArea">
                        <i class="fas fa-camera"></i>
                        <p>انقر لاختيار صورة أو فيديو للقصة</p>
                        <input type="file" id="storyFileInput" style="display: none;" accept="image/*,video/*">
                    </div>
                    <div class="story-preview" id="storyPreview" style="display: none;">
                        <img id="storyPreviewImage" src="" alt="معاينة القصة">
                        <video id="storyPreviewVideo" controls style="display: none;"></video>
                    </div>
                    <div class="form-group">
                        <label for="storyCaption">تعليق القصة</label>
                        <textarea id="storyCaption" rows="3" placeholder="اكتب تعليقاً للقصة..."></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelStoryBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">نشر القصة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج محادثة جديدة -->
    <div class="modal" id="newChatModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>بدء محادثة جديدة</h3>
                <button class="modal-close" id="closeNewChatModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="search-input-wrapper">
                    <i class="fas fa-search"></i>
                    <input type="text" id="userSearchInput" placeholder="ابحث عن مستخدم...">
                </div>
                <div class="users-list" id="usersList">
                    <!-- سيتم ملؤها ديناميكياً -->
                </div>
            </div>
        </div>
    </div>

    <!-- نموذج نسيان كلمة المرور -->
    <div class="modal" id="forgotPasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>استعادة كلمة المرور</h3>
                <button class="modal-close" id="closeForgotPasswordModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="forgotPasswordEmail">البريد الإلكتروني</label>
                        <input type="email" id="forgotPasswordEmail" required placeholder="ادخل بريدك الإلكتروني">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelForgotPasswordBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إرسال رابط الاستعادة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- السكريبتات -->
    <script src="js/config.js"></script>
    <script src="js/client.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker للتطبيق التقدمي -->
    <script>
        // تسجيل Service Worker للتطبيق التقدمي
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registered successfully');
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }

        // منع سلوك السحب للتحديث على الأجهزة المحمولة
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });

        // إعدادات الأداء
        if ('connection' in navigator) {
            const connection = navigator.connection;
            if (connection.saveData) {
                // تقليل جودة الصور إذا كان وضع توفير البيانات مفعلاً
                document.documentElement.classList.add('save-data');
            }
        }
    </script>
</body>
</html>
