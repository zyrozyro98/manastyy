<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المنصة التعليمية المتطورة - نظام الإدارة المتكامل</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.14.0/index.min.css">
    <link rel="stylesheet" href="css/css.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.14.0/index.min.js"></script>
    <style>
        /* تحسينات إضافية */
        .notification {
            position: fixed;
            top: 100px;
            left: 20px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            border-right: 4px solid #4361ee;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 1rem;
            max-width: 400px;
            animation: slideInLeft 0.3s ease;
        }

        .notification.success {
            border-right-color: #4cc9f0;
        }

        .notification.error {
            border-right-color: #f72585;
        }

        .notification.warning {
            border-right-color: #f8961e;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-spinner {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4361ee;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .user-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }

        .status-online {
            color: #4cc9f0;
        }

        .status-offline {
            color: #6c757d;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-online .status-dot {
            background: #4cc9f0;
            animation: pulse 2s infinite;
        }

        .status-offline .status-dot {
            background: #6c757d;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .typing-indicator {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            color: #6c757d;
            display: none;
        }

        .typing-dots {
            display: inline-flex;
            gap: 2px;
            margin-left: 0.5rem;
        }

        .typing-dots span {
            width: 4px;
            height: 4px;
            background: #6c757d;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .message-status {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }

        .search-result-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid #f8f9fa;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background: #f8f9fa;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .no-results {
            padding: 2rem;
            text-align: center;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- شاشة الترحيب -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <div class="welcome-logo">
                <div class="logo-icon large">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1>المنصة التعليمية</h1>
                <p>نظام إدارة تعليمي متكامل ومتطور</p>
            </div>
            
            <div class="welcome-features">
                <div class="feature">
                    <i class="fas fa-comments"></i>
                    <span>دردشة مباشرة</span>
                </div>
                <div class="feature">
                    <i class="fas fa-users"></i>
                    <span>مجموعات تعليمية</span>
                </div>
                <div class="feature">
                    <i class="fas fa-play-circle"></i>
                    <span>فصول افتراضية</span>
                </div>
                <div class="feature">
                    <i class="fas fa-chart-line"></i>
                    <span>تتبع التقدم</span>
                </div>
                <div class="feature">
                    <i class="fas fa-shield-alt"></i>
                    <span>أمان متكامل</span>
                </div>
                <div class="feature">
                    <i class="fas fa-mobile-alt"></i>
                    <span>متجاوب مع الجوال</span>
                </div>
            </div>
            
            <button class="btn btn-primary btn-lg" id="startAppBtn">
                <i class="fas fa-rocket"></i>
                ابدأ الآن
            </button>

            <div class="welcome-stats" style="margin-top: 2rem; display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap;">
                <div class="stat" style="text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: #4cc9f0;">1000+</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">طالب مسجل</div>
                </div>
                <div class="stat" style="text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: #f72585;">50+</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">معلم نشط</div>
                </div>
                <div class="stat" style="text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold; color: #f8961e;">100+</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">مادة تعليمية</div>
                </div>
            </div>
        </div>
    </div>

    <!-- حالة الاتصال -->
    <div class="connection-status" id="connectionStatus">
        <i class="fas fa-wifi"></i>
        <span>جاري الاتصال...</span>
    </div>

    <!-- إشعار التحديث -->
    <div class="update-notification" id="updateNotification" style="display: none;">
        <div class="update-content">
            <i class="fas fa-sync-alt fa-spin"></i>
            <div class="update-info">
                <strong>تحديث جديد متاح</strong>
                <span>يتم تحميل التحديثات تلقائياً</span>
            </div>
        </div>
        <button class="btn btn-sm btn-outline" id="reloadBtn">
            <i class="fas fa-redo"></i>
            تحديث الآن
        </button>
    </div>

    <!-- الهيدر -->
    <header class="header" id="header">
        <div class="header-content">
            <a href="#" class="logo" data-page="home">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div>
                    <div class="logo-text">المنصة التعليمية</div>
                    <div class="logo-subtitle">نظام الإدارة المتكامل</div>
                </div>
            </a>

            <nav class="nav">
                <a href="#" class="nav-item" data-page="home">
                    <i class="fas fa-home"></i>
                    الرئيسية
                </a>
                <a href="#" class="nav-item" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    لوحة التحكم
                </a>
                <a href="#" class="nav-item" data-page="chat">
                    <i class="fas fa-comments"></i>
                    الدردشة
                    <span class="nav-item-badge" id="unreadMessagesCount" style="display: none;">0</span>
                </a>
                <a href="#" class="nav-item" data-page="stories">
                    <i class="fas fa-history"></i>
                    القصص
                </a>
                <a href="#" class="nav-item" data-page="groups">
                    <i class="fas fa-users"></i>
                    المجموعات
                </a>
                <a href="#" class="nav-item" data-page="channels">
                    <i class="fas fa-broadcast-tower"></i>
                    القنوات
                </a>
                <a href="#" class="nav-item" data-page="media">
                    <i class="fas fa-photo-video"></i>
                    الوسائط
                </a>
                <a href="#" class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    الإعدادات
                </a>
                <a href="#" class="nav-item hidden" id="loginBtn" data-page="login">
                    <i class="fas fa-sign-in-alt"></i>
                    تسجيل الدخول
                </a>
                <a href="#" class="nav-item hidden" id="registerBtn" data-page="register">
                    <i class="fas fa-user-plus"></i>
                    إنشاء حساب
                </a>
                <a href="#" class="nav-item hidden" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    تسجيل الخروج
                </a>
            </nav>

            <div class="user-info hidden" id="userInfo">
                <div class="user-avatar">
                    <span id="userAvatarText">م</span>
                </div>
                <div class="user-details">
                    <div class="user-name" id="userNameDisplay">محمد أحمد</div>
                    <div class="user-role" id="userRoleDisplay">طالب</div>
                    <div class="user-status status-online" id="userStatus">
                        <span class="status-dot"></span>
                        <span>متصل</span>
                    </div>
                </div>
            </div>

            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- القائمة المتنقلة -->
    <div class="mobile-menu" id="mobileMenu">
        <nav class="mobile-nav">
            <a href="#" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
                الرئيسية
            </a>
            <a href="#" class="nav-item" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                لوحة التحكم
            </a>
            <a href="#" class="nav-item" data-page="chat">
                <i class="fas fa-comments"></i>
                الدردشة
                <span class="nav-item-badge" id="unreadMessagesCountMobile" style="display: none;">0</span>
            </a>
            <a href="#" class="nav-item" data-page="stories">
                <i class="fas fa-history"></i>
                القصص
            </a>
            <a href="#" class="nav-item" data-page="groups">
                <i class="fas fa-users"></i>
                المجموعات
            </a>
            <a href="#" class="nav-item" data-page="channels">
                <i class="fas fa-broadcast-tower"></i>
                القنوات
            </a>
            <a href="#" class="nav-item" data-page="media">
                <i class="fas fa-photo-video"></i>
                الوسائط
            </a>
            <a href="#" class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                الإعدادات
            </a>
            <a href="#" class="nav-item hidden" id="loginBtnMobile" data-page="login">
                <i class="fas fa-sign-in-alt"></i>
                تسجيل الدخول
            </a>
            <a href="#" class="nav-item hidden" id="registerBtnMobile" data-page="register">
                <i class="fas fa-user-plus"></i>
                إنشاء حساب
            </a>
            <a href="#" class="nav-item hidden" id="logoutBtnMobile">
                <i class="fas fa-sign-out-alt"></i>
                تسجيل الخروج
            </a>
        </nav>
    </div>

    <!-- طبقة التعتيم -->
    <div class="overlay" id="overlay"></div>

    <!-- المحتوى الرئيسي -->
    <main class="main-content">
        <!-- الصفحة الرئيسية -->
        <div class="page active" id="home-page">
            <div class="home-hero">
                <div class="hero-content">
                    <h1>مرحباً بك في المنصة التعليمية</h1>
                    <p>منصة متكاملة للتعلم والتعاون والتواصل بين الطلاب والمعلمين</p>
                    <div class="hero-actions">
                        <button class="btn btn-primary btn-lg" data-page="register">
                            <i class="fas fa-user-plus"></i>
                            انضم إلينا
                        </button>
                        <button class="btn btn-outline btn-lg" data-page="login">
                            <i class="fas fa-sign-in-alt"></i>
                            تسجيل الدخول
                        </button>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-graduation-cap"></i>
                </div>
            </div>

            <div class="features-section">
                <h2 class="section-title">مميزات المنصة</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>دردشة مباشرة</h3>
                        <p>تواصل فوري مع الزملاء والمعلمين عبر نظام دردشة متكامل مع إمكانية إرسال الوسائط والملفات</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>مجموعات تعليمية</h3>
                        <p>أنشئ مجموعات دراسية وناقش مواضيعك مع زملائك في بيئة تعاونية آمنة</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-broadcast-tower"></i>
                        </div>
                        <h3>قنوات البث</h3>
                        <p>انضم إلى قنوات تعليمية متخصصة واحصل على آخر المستجدات والإعلانات المهمة</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3>القصص التعليمية</h3>
                        <p>شارك تجاربك التعليمية عبر القصص التفاعلية التي تختفي بعد 24 ساعة</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-photo-video"></i>
                        </div>
                        <h3>وسائط متعددة</h3>
                        <p>شارك ومشاهدة الوسائط التعليمية بجودة عالية مع دعم جميع أنواع الملفات</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>تتبع التقدم</h3>
                        <p>تابع تقدمك التعليمي واحصل على تقارير أداء مفصلة وإحصائيات دقيقة</p>
                    </div>
                </div>
            </div>

            <div class="stats-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 4rem 2rem; border-radius: 12px; margin: 3rem 0;">
                <h2 class="section-title" style="color: white; text-align: center;">إحصائيات المنصة</h2>
                <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-top: 2rem;">
                    <div class="stat-item" style="text-align: center;">
                        <div class="stat-number" style="font-size: 3rem; font-weight: bold;">1,250</div>
                        <div class="stat-label" style="font-size: 1.2rem;">طالب مسجل</div>
                    </div>
                    <div class="stat-item" style="text-align: center;">
                        <div class="stat-number" style="font-size: 3rem; font-weight: bold;">85</div>
                        <div class="stat-label" style="font-size: 1.2rem;">معلم نشط</div>
                    </div>
                    <div class="stat-item" style="text-align: center;">
                        <div class="stat-number" style="font-size: 3rem; font-weight: bold;">156</div>
                        <div class="stat-label" style="font-size: 1.2rem;">مادة تعليمية</div>
                    </div>
                    <div class="stat-item" style="text-align: center;">
                        <div class="stat-number" style="font-size: 3rem; font-weight: bold;">24/7</div>
                        <div class="stat-label" style="font-size: 1.2rem;">دعم فني</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة تسجيل الدخول -->
        <div class="page" id="login-page">
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <h2>تسجيل الدخول</h2>
                        <p>ادخل إلى حسابك للمتابعة</p>
                    </div>
                    <form class="auth-form" id="loginForm">
                        <div class="form-group">
                            <label for="loginEmail">البريد الإلكتروني</label>
                            <input type="email" id="loginEmail" name="email" required placeholder="ادخل بريدك الإلكتروني">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">كلمة المرور</label>
                            <input type="password" id="loginPassword" name="password" required placeholder="ادخل كلمة المرور">
                        </div>
                        <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                            <label style="margin: 0;">
                                <input type="checkbox" id="rememberMe"> تذكرني
                            </label>
                            <a href="#" style="color: #4361ee; text-decoration: none;">نسيت كلمة المرور؟</a>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i>
                            تسجيل الدخول
                        </button>
                    </form>
                    <div class="auth-divider" style="text-align: center; margin: 1.5rem 0; position: relative;">
                        <span style="background: white; padding: 0 1rem; color: #6c757d;">أو</span>
                        <hr style="position: absolute; top: 50%; left: 0; right: 0; z-index: -1; margin: 0;">
                    </div>
                    <div class="social-login" style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                        <button type="button" class="btn btn-outline btn-block" style="flex: 1;">
                            <i class="fab fa-google" style="color: #DB4437;"></i>
                            جوجل
                        </button>
                        <button type="button" class="btn btn-outline btn-block" style="flex: 1;">
                            <i class="fab fa-microsoft" style="color: #0078D4;"></i>
                            مايكروسوفت
                        </button>
                    </div>
                    <div class="auth-footer">
                        <p>ليس لديك حساب؟ <a href="#" data-page="register">أنشئ حساب جديد</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة إنشاء حساب -->
        <div class="page" id="register-page">
            <div class="auth-container">
                <div class="auth-card">
                    <div class="auth-header">
                        <h2>إنشاء حساب جديد</h2>
                        <p>انضم إلى منصتنا التعليمية</p>
                    </div>
                    <form class="auth-form" id="registerForm">
                        <div class="form-group">
                            <label for="registerName">الاسم الكامل</label>
                            <input type="text" id="registerName" name="name" required placeholder="ادخل اسمك الكامل">
                        </div>
                        <div class="form-group">
                            <label for="registerEmail">البريد الإلكتروني</label>
                            <input type="email" id="registerEmail" name="email" required placeholder="ادخل بريدك الإلكتروني">
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">كلمة المرور</label>
                            <input type="password" id="registerPassword" name="password" required placeholder="اختر كلمة مرور قوية">
                            <div class="password-strength" style="margin-top: 0.5rem; font-size: 0.8rem; color: #6c757d;">
                                <div id="passwordStrength" style="height: 4px; background: #dee2e6; border-radius: 2px; margin-top: 0.25rem;">
                                    <div id="passwordStrengthBar" style="height: 100%; width: 0%; background: #f72585; border-radius: 2px; transition: all 0.3s;"></div>
                                </div>
                                <div id="passwordRequirements" style="margin-top: 0.5rem;">
                                    يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="registerConfirmPassword">تأكيد كلمة المرور</label>
                            <input type="password" id="registerConfirmPassword" name="confirmPassword" required placeholder="أعد إدخال كلمة المرور">
                        </div>
                        <div class="form-group">
                            <label for="registerRole">الدور</label>
                            <select id="registerRole" name="role" required>
                                <option value="">اختر دورك</option>
                                <option value="student">طالب</option>
                                <option value="teacher">معلم</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="acceptTerms" required>
                                أوافق على <a href="#" style="color: #4361ee;">شروط الاستخدام</a> و <a href="#" style="color: #4361ee;">سياسة الخصوصية</a>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-user-plus"></i>
                            إنشاء حساب
                        </button>
                    </form>
                    <div class="auth-footer">
                        <p>لديك حساب بالفعل؟ <a href="#" data-page="login">سجل الدخول</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة لوحة التحكم -->
        <div class="page" id="dashboard-page">
            <div class="dashboard-header">
                <h1 class="section-title">
                    <i class="fas fa-tachometer-alt"></i>
                    لوحة التحكم
                </h1>
                <p id="dashboardWelcome">مرحباً بك في المنصة التعليمية</p>
            </div>
            
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalUsers">0</div>
                        <div class="stat-label">إجمالي المستخدمين</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalMessages">0</div>
                        <div class="stat-label">الرسائل المرسلة</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalStories">0</div>
                        <div class="stat-label">القصص النشطة</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-broadcast-tower"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalChannels">0</div>
                        <div class="stat-label">القنوات</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-content" style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-top: 2rem;">
                <div class="recent-activities">
                    <h3>النشاطات الأخيرة</h3>
                    <div class="activities-list" id="activitiesList">
                        <div class="activity-item">
                            <i class="fas fa-user-plus" style="color: #4cc9f0;"></i>
                            <div class="activity-content">
                                <p>انضم مستخدم جديد إلى المنصة</p>
                                <span class="activity-time">منذ قليل</span>
                            </div>
                        </div>
                        <div class="activity-item">
                            <i class="fas fa-comment" style="color: #4361ee;"></i>
                            <div class="activity-content">
                                <p>تم إرسال رسالة جديدة في المحادثة</p>
                                <span class="activity-time">منذ 5 دقائق</span>
                            </div>
                        </div>
                        <div class="activity-item">
                            <i class="fas fa-camera" style="color: #f72585;"></i>
                            <div class="activity-content">
                                <p>تم نشر قصة جديدة</p>
                                <span class="activity-time">منذ 15 دقيقة</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="quick-actions">
                    <h3>إجراءات سريعة</h3>
                    <div class="actions-grid" style="display: grid; gap: 1rem;">
                        <button class="btn btn-primary btn-block" data-page="chat">
                            <i class="fas fa-comments"></i>
                            بدء محادثة جديدة
                        </button>
                        <button class="btn btn-outline btn-block" data-page="groups">
                            <i class="fas fa-users"></i>
                            إنشاء مجموعة
                        </button>
                        <button class="btn btn-outline btn-block" data-page="channels">
                            <i class="fas fa-broadcast-tower"></i>
                            إنشاء قناة
                        </button>
                        <button class="btn btn-outline btn-block" data-page="stories">
                            <i class="fas fa-camera"></i>
                            نشر قصة
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة الدردشة -->
        <div class="page" id="chat-page">
            <div class="chat-container">
                <div class="chat-sidebar" id="chatSidebar">
                    <div class="chat-header">
                        <h3>المحادثات</h3>
                        <button class="btn btn-primary btn-sm" id="newChatBtn" style="margin-right: 10px;">
                            <i class="fas fa-plus"></i>
                            محادثة جديدة
                        </button>
                    </div>
                    
                    <div class="chat-search" style="position: relative;">
                        <input type="text" id="chatSearchInput" placeholder="بحث في المحادثات...">
                        <div class="search-results" id="searchResults"></div>
                    </div>
                    
                    <div class="conversations-list" id="conversationsList">
                        <!-- سيتم ملء المحادثات ديناميكياً -->
                    </div>
                </div>
                
                <div class="chat-main">
                    <div class="chat-header" id="activeChatHeader">
                        <div class="chat-user-info">
                            <div class="conversation-avatar small">
                                <span id="activeChatAvatar">?</span>
                            </div>
                            <div>
                                <div class="conversation-name" id="activeChatName">اختر محادثة</div>
                                <div class="user-status-text" id="activeChatStatus">غير متصل</div>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="chat-tool-btn" id="voiceCallBtn" title="مكالمة صوتية">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="chat-tool-btn" id="videoCallBtn" title="مكالمة فيديو">
                                <i class="fas fa-video"></i>
                            </button>
                            <button class="chat-tool-btn" id="chatInfoBtn" title="معلومات المحادثة">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        <div class="empty-chat" id="emptyChat">
                            <i class="fas fa-comments"></i>
                            <h3>مرحباً في الدردشة</h3>
                            <p>اختر محادثة لبدء التحدث</p>
                        </div>
                    </div>

                    <div class="typing-indicator" id="typingIndicator">
                        <!-- سيتم ملء مؤشر الكتابة ديناميكياً -->
                    </div>
                    
                    <div class="chat-input-container" id="chatInputContainer" style="display: none;">
                        <div class="chat-input-tools">
                            <button class="chat-tool-btn" id="attachFileBtn" title="إرفاق ملف">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button class="chat-tool-btn" id="emojiToggle" title="إدراج إيموجي">
                                <i class="fas fa-smile"></i>
                            </button>
                            <input type="file" id="fileInput" style="display: none;" accept="image/*,video/*,audio/*,.pdf,.doc,.docx">
                        </div>
                        
                        <div class="chat-input-wrapper">
                            <input type="text" placeholder="اكتب رسالة..." id="chatInput">
                        </div>
                        
                        <button class="send-btn" id="sendMessageBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    
                    <div class="emoji-picker-container" id="emojiPickerContainer">
                        <emoji-picker></emoji-picker>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة القصص -->
        <div class="page" id="stories-page">
            <div class="stories-header">
                <h1 class="section-title">
                    <i class="fas fa-history"></i>
                    القصص
                </h1>
                <button class="btn btn-primary" id="createStoryBtn">
                    <i class="fas fa-plus"></i>
                    إضافة قصة
                </button>
            </div>
            
            <div class="stories-container" id="storiesContainer">
                <!-- سيتم ملء القصص ديناميكياً -->
            </div>

            <div class="story-viewer" id="storyViewer" style="display: none;">
                <button class="story-close" id="storyClose">
                    <i class="fas fa-times"></i>
                </button>
                <div class="story-content">
                    <div class="story-progress" id="storyProgress">
                        <!-- سيتم ملء شريط التقدم ديناميكياً -->
                    </div>
                    <img id="currentStoryImage" src="" alt="قصة" style="width: 100%; height: 100%; object-fit: cover;">
                    <div class="story-info">
                        <div class="story-author-avatar">
                            <span id="storyAuthorAvatar">?</span>
                        </div>
                        <div class="story-author-info">
                            <div class="story-author-name" id="storyAuthorName"></div>
                            <div class="story-time" id="storyTime"></div>
                        </div>
                    </div>
                    <div class="story-nav prev" id="storyPrev">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="story-nav next" id="storyNext">
                        <i class="fas fa-chevron-left"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- صفحة المجموعات -->
        <div class="page" id="groups-page">
            <div class="groups-header">
                <h1 class="section-title">
                    <i class="fas fa-users"></i>
                    المجموعات التعليمية
                </h1>
                <button class="btn btn-primary" id="createGroupBtn">
                    <i class="fas fa-plus"></i>
                    إنشاء مجموعة
                </button>
            </div>
            
            <div class="groups-grid" id="groupsGrid">
                <!-- سيتم ملء المجموعات ديناميكياً -->
            </div>
        </div>

        <!-- صفحة القنوات -->
        <div class="page" id="channels-page">
            <div class="channels-header">
                <h1 class="section-title">
                    <i class="fas fa-broadcast-tower"></i>
                    القنوات التعليمية
                </h1>
                <button class="btn btn-primary" id="createChannelBtn">
                    <i class="fas fa-plus"></i>
                    إنشاء قناة
                </button>
            </div>
            
            <div class="channels-grid" id="channelsGrid">
                <!-- سيتم ملء القنوات ديناميكياً -->
            </div>
        </div>

        <!-- صفحة الوسائط -->
        <div class="page" id="media-page">
            <div class="media-header">
                <h1 class="section-title">
                    <i class="fas fa-photo-video"></i>
                    الوسائط التعليمية
                </h1>
                <div class="media-actions">
                    <button class="btn btn-primary" id="uploadMediaBtn">
                        <i class="fas fa-upload"></i>
                        رفع وسائط
                    </button>
                    <div class="media-filter">
                        <select id="mediaFilter">
                            <option value="all">جميع الوسائط</option>
                            <option value="image">الصور</option>
                            <option value="video">الفيديوهات</option>
                            <option value="document">المستندات</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="media-grid" id="mediaGrid">
                <!-- سيتم ملء الوسائط ديناميكياً -->
            </div>
        </div>

        <!-- صفحة الإعدادات -->
        <div class="page" id="settings-page">
            <div class="settings-container">
                <h1 class="section-title">
                    <i class="fas fa-cog"></i>
                    الإعدادات
                </h1>
                
                <div class="settings-grid">
                    <div class="settings-sidebar">
                        <div class="settings-nav">
                            <button class="settings-nav-item active" data-tab="profile">
                                <i class="fas fa-user"></i>
                                الملف الشخصي
                            </button>
                            <button class="settings-nav-item" data-tab="privacy">
                                <i class="fas fa-shield-alt"></i>
                                الخصوصية
                            </button>
                            <button class="settings-nav-item" data-tab="notifications">
                                <i class="fas fa-bell"></i>
                                الإشعارات
                            </button>
                            <button class="settings-nav-item" data-tab="appearance">
                                <i class="fas fa-palette"></i>
                                المظهر
                            </button>
                            <button class="settings-nav-item" data-tab="security">
                                <i class="fas fa-lock"></i>
                                الأمان
                            </button>
                        </div>
                    </div>
                    
                    <div class="settings-content">
                        <div class="settings-tab active" id="profile-tab">
                            <h3>الملف الشخصي</h3>
                            <form class="settings-form" id="profileForm">
                                <div class="form-group">
                                    <label for="profileName">الاسم الكامل</label>
                                    <input type="text" id="profileName" value="محمد أحمد">
                                </div>
                                <div class="form-group">
                                    <label for="profileEmail">البريد الإلكتروني</label>
                                    <input type="email" id="profileEmail" value="mohamed@example.com">
                                </div>
                                <div class="form-group">
                                    <label for="profilePhone">رقم الهاتف</label>
                                    <input type="tel" id="profilePhone" placeholder="أدخل رقم هاتفك">
                                </div>
                                <div class="form-group">
                                    <label for="profileBio">نبذة شخصية</label>
                                    <textarea id="profileBio" rows="4" placeholder="اكتب نبذة عن نفسك..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label>صورة الملف الشخصي</label>
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div class="user-avatar large">
                                            <span id="profileAvatarText">م</span>
                                        </div>
                                        <button type="button" class="btn btn-outline">
                                            <i class="fas fa-camera"></i>
                                            تغيير الصورة
                                        </button>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary">حفظ التغييرات</button>
                            </form>
                        </div>
                        
                        <div class="settings-tab" id="privacy-tab">
                            <h3>إعدادات الخصوصية</h3>
                            <div class="privacy-settings">
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إظهار حالة الاتصال</h4>
                                        <p>السماح للآخرين برؤية ما إذا كنت متصلاً أم لا</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إظهار آخر ظهور</h4>
                                        <p>السماح للآخرين برؤية وقت آخر ظهور لك</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>الملف الشخصي العام</h4>
                                        <p>جعل ملفك الشخصي مرئياً للجميع</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>السماح بإرسال الرسائل</h4>
                                        <p>السماح للآخرين بإرسال رسائل مباشرة لك</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-tab" id="notifications-tab">
                            <h3>إعدادات الإشعارات</h3>
                            <div class="privacy-settings">
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إشعارات الرسائل</h4>
                                        <p>تلقي إشعارات عند وصول رسائل جديدة</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إشعارات المجموعات</h4>
                                        <p>تلقي إشعارات من المجموعات</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إشعارات القنوات</h4>
                                        <p>تلقي إشعارات من القنوات المشترك فيها</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="privacy-item">
                                    <div class="privacy-info">
                                        <h4>إشعارات البريد الإلكتروني</h4>
                                        <p>تلقي إشعارات عبر البريد الإلكتروني</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-tab" id="appearance-tab">
                            <h3>إعدادات المظهر</h3>
                            <div class="form-group">
                                <label for="themeSelect">السمة</label>
                                <select id="themeSelect" class="form-control">
                                    <option value="auto">تلقائي</option>
                                    <option value="light">فاتح</option>
                                    <option value="dark">داكن</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="fontSize">حجم الخط</label>
                                <select id="fontSize" class="form-control">
                                    <option value="small">صغير</option>
                                    <option value="medium" selected>متوسط</option>
                                    <option value="large">كبير</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="language">اللغة</label>
                                <select id="language" class="form-control">
                                    <option value="ar" selected>العربية</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-tab" id="security-tab">
                            <h3>إعدادات الأمان</h3>
                            <div class="security-settings">
                                <div class="security-item">
                                    <h4>تغيير كلمة المرور</h4>
                                    <form class="security-form">
                                        <div class="form-group">
                                            <label for="currentPassword">كلمة المرور الحالية</label>
                                            <input type="password" id="currentPassword" placeholder="أدخل كلمة المرور الحالية">
                                        </div>
                                        <div class="form-group">
                                            <label for="newPassword">كلمة المرور الجديدة</label>
                                            <input type="password" id="newPassword" placeholder="أدخل كلمة المرور الجديدة">
                                        </div>
                                        <div class="form-group">
                                            <label for="confirmNewPassword">تأكيد كلمة المرور الجديدة</label>
                                            <input type="password" id="confirmNewPassword" placeholder="أعد إدخال كلمة المرور الجديدة">
                                        </div>
                                        <button type="submit" class="btn btn-primary">تغيير كلمة المرور</button>
                                    </form>
                                </div>
                                <div class="security-item">
                                    <h4>جلسات التسجيل</h4>
                                    <div class="sessions-list">
                                        <div class="session-item">
                                            <div class="session-info">
                                                <div class="session-device">Chrome على Windows</div>
                                                <div class="session-location">الرياض، السعودية</div>
                                                <div class="session-time">آخر نشاط: منذ 5 دقائق</div>
                                            </div>
                                            <button class="btn btn-outline btn-sm">إنهاء الجلسة</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- شريط الأدوات السريع -->
    <div class="quick-actions-bar" id="quickActionsBar">
        <button class="quick-action" data-page="chat" title="الدردشة">
            <i class="fas fa-comments"></i>
        </button>
        <button class="quick-action" data-page="stories" title="القصص">
            <i class="fas fa-history"></i>
        </button>
        <button class="quick-action" data-page="groups" title="المجموعات">
            <i class="fas fa-users"></i>
        </button>
        <button class="quick-action" data-page="channels" title="القنوات">
            <i class="fas fa-broadcast-tower"></i>
        </button>
        <button class="quick-action" data-page="media" title="الوسائط">
            <i class="fas fa-photo-video"></i>
        </button>
    </div>

    <!-- الزر العائم -->
    <button class="floating-action-btn" id="floatingActionBtn">
        <i class="fas fa-plus"></i>
    </button>

    <!-- النماذج المنبثقة -->
    <!-- نموذج إنشاء مجموعة -->
    <div class="modal" id="createGroupModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء مجموعة جديدة</h3>
                <button class="modal-close" id="closeGroupModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createGroupForm">
                    <div class="form-group">
                        <label for="groupName">اسم المجموعة</label>
                        <input type="text" id="groupName" name="groupName" required placeholder="ادخل اسم المجموعة">
                    </div>
                    <div class="form-group">
                        <label for="groupDescription">وصف المجموعة</label>
                        <textarea id="groupDescription" name="groupDescription" rows="3" placeholder="ادخل وصف المجموعة"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="groupPrivacy">خصوصية المجموعة</label>
                        <select id="groupPrivacy" name="groupPrivacy">
                            <option value="public">عامة</option>
                            <option value="private">خاصة</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelGroupBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إنشاء المجموعة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج إنشاء قناة -->
    <div class="modal" id="createChannelModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء قناة جديدة</h3>
                <button class="modal-close" id="closeChannelModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createChannelForm">
                    <div class="form-group">
                        <label for="channelName">اسم القناة</label>
                        <input type="text" id="channelName" name="channelName" required placeholder="ادخل اسم القناة">
                    </div>
                    <div class="form-group">
                        <label for="channelDescription">وصف القناة</label>
                        <textarea id="channelDescription" name="channelDescription" rows="3" placeholder="ادخل وصف القناة"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="channelCategory">تصنيف القناة</label>
                        <select id="channelCategory" name="channelCategory">
                            <option value="education">تعليمي</option>
                            <option value="entertainment">ترفيهي</option>
                            <option value="news">أخباري</option>
                            <option value="technology">تكنولوجيا</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelChannelBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">إنشاء القناة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج إنشاء قصة -->
    <div class="modal" id="createStoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء قصة جديدة</h3>
                <button class="modal-close" id="closeStoryModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createStoryForm">
                    <div class="upload-area" id="storyUploadArea">
                        <i class="fas fa-camera"></i>
                        <p>انقر لاختيار صورة أو فيديو للقصة</p>
                        <input type="file" id="storyFileInput" style="display: none;" accept="image/*,video/*">
                    </div>
                    <div class="form-group">
                        <label for="storyCaption">تعليق القصة</label>
                        <textarea id="storyCaption" rows="3" placeholder="اكتب تعليقاً للقصة..."></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelStoryBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">نشر القصة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نموذج رفع الوسائط -->
    <div class="modal" id="uploadMediaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>رفع وسائط جديدة</h3>
                <button class="modal-close" id="closeUploadModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="uploadMediaForm">
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>اسحب وأفلت الملفات هنا أو انقر للاختيار</p>
                        <input type="file" id="mediaFileInput" multiple style="display: none;" accept="image/*,video/*,.pdf,.doc,.docx">
                    </div>
                    <div class="form-group">
                        <label for="mediaTitle">عنوان الوسائط</label>
                        <input type="text" id="mediaTitle" placeholder="ادخل عنوان الوسائط">
                    </div>
                    <div class="form-group">
                        <label for="mediaDescription">وصف الوسائط</label>
                        <textarea id="mediaDescription" rows="3" placeholder="ادخل وصف الوسائط"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-outline" id="cancelUploadBtn">إلغاء</button>
                        <button type="submit" class="btn btn-primary">رفع الوسائط</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- السكريبتات -->
    <script src="js/app.js"></script>

    <script>
        // تحسينات إضافية للواجهة
        document.addEventListener('DOMContentLoaded', function() {
            // إدارة النماذج المنبثقة
            const modals = document.querySelectorAll('.modal');
            const modalTriggers = document.querySelectorAll('[data-modal]');
            
            modalTriggers.forEach(trigger => {
                trigger.addEventListener('click', function() {
                    const modalId = this.getAttribute('data-modal');
                    const modal = document.getElementById(modalId);
                    if (modal) {
                        modal.style.display = 'flex';
                    }
                });
            });

            // إغلاق النماذج
            modals.forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                    }
                });

                const closeButtons = modal.querySelectorAll('.modal-close');
                closeButtons.forEach(btn => {
                    btn.addEventListener('click', function() {
                        modal.style.display = 'none';
                    });
                });
            });

            // تحسين تجربة المستخدم
            const passwordInput = document.getElementById('registerPassword');
            if (passwordInput) {
                passwordInput.addEventListener('input', function() {
                    const strengthBar = document.getElementById('passwordStrengthBar');
                    const password = this.value;
                    let strength = 0;

                    if (password.length >= 8) strength += 25;
                    if (/[A-Z]/.test(password)) strength += 25;
                    if (/[0-9]/.test(password)) strength += 25;
                    if (/[^A-Za-z0-9]/.test(password)) strength += 25;

                    strengthBar.style.width = strength + '%';
                    
                    if (strength < 50) {
                        strengthBar.style.background = '#f72585';
                    } else if (strength < 75) {
                        strengthBar.style.background = '#f8961e';
                    } else {
                        strengthBar.style.background = '#4cc9f0';
                    }
                });
            }

            // تحسين التنقل
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // تحسينات للجوال
            if (window.innerWidth <= 768) {
                document.body.classList.add('mobile-view');
            }

            window.addEventListener('resize', function() {
                if (window.innerWidth <= 768) {
                    document.body.classList.add('mobile-view');
                } else {
                    document.body.classList.remove('mobile-view');
                }
            });

            // تحميل سريع للصور
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.addEventListener('load', function() {
                    this.classList.add('loaded');
                });
            });
        });

        // وظائف مساعدة
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info'}"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function showLoading(message = 'جاري التحميل...') {
            const loading = document.createElement('div');
            loading.className = 'loading-overlay';
            loading.id = 'loading-overlay';
            loading.innerHTML = `
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>${message}</p>
                </div>
            `;
            document.body.appendChild(loading);
        }

        function hideLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                loading.remove();
            }
        }
    </script>
</body>
</html>
